(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7237:(e,t,n)=>{Promise.resolve().then(n.bind(n,6894))},6894:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var a=n(5155),r=n(2115);let l=e=>{let{handleWalkingAnimation:t,handlehandstandAnimation:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"",style:{marginBottom:"10px",padding:"10px",width:"100%"},onClick:()=>{t()},children:"Walking"}),(0,a.jsx)("button",{className:"",style:{marginBottom:"10px",padding:"10px",width:"100%"},onClick:()=>n(),children:"hand stand"})]})},i=e=>{let{selectedSvg:t,parseSvgLayers:n,selectedLayers:r,handleLayerClick:l}=e;return(0,a.jsxs)("div",{className:"layers-container",children:[(0,a.jsx)("h1",{children:"Layers"}),(0,a.jsx)("ul",{children:t&&n(t).map(e=>(0,a.jsxs)("li",{children:[(0,a.jsx)("button",{onClick:()=>l(e.id),style:{background:r.includes(e.id)?"lightblue":"transparent",padding:"12px",cursor:"pointer",margin:"4px 0",width:"100%",color:"black"},children:e.id}),e.children.length>0&&(0,a.jsx)("ul",{style:{paddingLeft:"16px"},children:e.children.map((t,n)=>(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>l(t.id||"".concat(e.id,"-child-").concat(n)),style:{background:r.includes(t.id||"".concat(e.id,"-child-").concat(n))?"lightcoral":"transparent",padding:"8px",cursor:"pointer",margin:"4px 0",width:"100%",color:"red"},children:t.id||"Child ".concat(n)})},"".concat(e.id,"-child-").concat(n)))})]},e.id))})]})},o=e=>{let{backgroundImage:t,svgContainerRef:n,svgPosition:l,setSvgPosition:i,applyLayerStyles:o,selectedSvg:s,selectedLayers:c}=e,d=(0,r.useRef)(!1),u=(0,r.useRef)({x:0,y:0}),m=e=>{e.preventDefault(),e.stopPropagation(),d.current=!1};return(0,r.useEffect)(()=>{if(!n.current||!s)return;let e=n.current,t=e.getContext("2d");if(!t){console.error("Canvas context could not be initialized.");return}t.clearRect(0,0,e.width,e.height);let a=o(s,c),r=new Image,i=new Blob([a],{type:"image/svg+xml"}),d=URL.createObjectURL(i);r.onload=()=>{t.clearRect(0,0,e.width,e.height),t.drawImage(r,l.x,l.y,e.width,e.height),URL.revokeObjectURL(d)},r.onerror=()=>{console.error("Failed to load SVG image.")},r.src=d},[n,s,c,l,o]),(0,a.jsx)("div",{className:"right-side-inner",style:{backgroundImage:t?"url(".concat(t,")"):"none",backgroundSize:"cover",backgroundPosition:"center",border:"1px solid #ccc",padding:"16px",overflow:"hidden"},children:(0,a.jsx)("canvas",{ref:n,height:600,width:800,className:"svg-preview-container",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),d.current=!0,u.current={x:e.clientX-l.x,y:e.clientY-l.y}},onMouseMove:e=>{e.preventDefault(),e.stopPropagation(),d.current&&i({x:e.clientX-u.current.x,y:e.clientY-u.current.y})},onMouseUp:m,onMouseLeave:m,style:{cursor:"move",border:"1px solid #000"}})})},s=e=>{let{slideForTimeline:t,selectedSvgIndex:n,handleSvgClick:r,currentReplayIndex:l,replayActivities:i,downloadVideo:o,playheadPosition:s,seconds:c}=e;return console.log(n),(0,a.jsxs)("div",{className:"timeline-container",children:[(0,a.jsx)("h3",{children:"Timeline:"}),(0,a.jsx)("button",{onClick:i,style:{marginTop:"20px"},children:"Render TimeLine"}),(0,a.jsx)("button",{onClick:o,style:{marginTop:"20px"},children:"Download in .Mp4"}),(0,a.jsx)("div",{className:"time-ruler",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px",marginBottom:"10px",position:"relative",height:"30px",borderBottom:"1px solid gray"},children:[...Array(30)].map((e,t)=>(0,a.jsx)("div",{style:{width:"3.33%",textAlign:"center",position:"relative"},children:(0,a.jsxs)("span",{style:{fontSize:"12px"},children:[t,"s"]})},t))}),(0,a.jsxs)("div",{className:"timeline",style:{position:"relative",height:"30px",backgroundColor:"#f0f0f0",border:"1px solid #ccc",marginBottom:"20px",transition:"left 0.2s linear"},children:[(0,a.jsx)("div",{className:"playhead",style:{position:"absolute",left:"".concat(s,"%"),width:"2px",height:"100%",backgroundColor:"red"}}),(0,a.jsxs)("p",{style:{position:"absolute",left:"".concat(s,"%")},children:[c+1,"s"]})]}),(0,a.jsx)("div",{className:"svg-container-for-timeline",children:t.map(e=>(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:e.svg},className:(e.index,"timeline"),onClick:()=>r(e.svg,e.index)}),(0,a.jsxs)("p",{children:["Animation: ",e.animationType||"None"]})]},e.index))})]})},c=e=>{let{setSvgDataList:t,selectedSvg:n,backgroundImage:l,svgContainerRef:i,setBackgroundImage:c,selectedLayers:d,slideForTimeline:u,playWalkingAnimation:m,selectedSvgIndex:g,replayActivities:h,downloadVideo:p,svgPosition:v,setSvgPosition:x,handleSvgClick:f,playheadPosition:y,seconds:S,currentReplayIndex:b}=e;return(0,r.useEffect)(()=>{let e=localStorage.getItem("uploadedSVGs");e&&t(JSON.parse(e));let n=localStorage.getItem("backgroundImage");n&&c(n)},[]),(0,a.jsx)(a.Fragment,{children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"main-heading",children:"Preview"}),(0,a.jsx)(o,{backgroundImage:l,svgContainerRef:i,svgPosition:v,applyLayerStyles:(e,t)=>{let n=new DOMParser().parseFromString(e,"image/svg+xml");return n.querySelectorAll("g").forEach(e=>{var n;let a=e.id||"layer-".concat(Array.from((null===(n=e.parentElement)||void 0===n?void 0:n.children)||[]).indexOf(e));t.includes(a)?(e.setAttribute("stroke","red"),e.setAttribute("stroke-width","4"),Array.from(e.children).forEach(n=>{t.includes(n.id||"".concat(a,"-child-").concat(Array.from(e.children).indexOf(n)))&&(n.setAttribute("stroke","red"),n.setAttribute("stroke-width","4"))})):(e.removeAttribute("stroke"),e.removeAttribute("stroke-width"),Array.from(e.children).forEach(e=>{e.removeAttribute("stroke"),e.removeAttribute("stroke-width")}))}),n.documentElement.outerHTML},selectedSvg:n,selectedLayers:d,setSvgPosition:x}),(0,a.jsx)(s,{currentReplayIndex:b,slideForTimeline:u,playWalkingAnimation:m,selectedSvgIndex:g,replayActivities:h,downloadVideo:p,handleSvgClick:f,playheadPosition:y,seconds:S})]}):(0,a.jsx)("p",{children:"Select an SVG to preview it here."})})},d="walking",u="handstand",m=()=>{let[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(null),[s,m]=(0,r.useState)([]),[g,h]=(0,r.useState)([]),[p,v]=(0,r.useState)(null),[x,f]=(0,r.useState)(null),[y,S]=(0,r.useState)(3e3),[b,w]=(0,r.useState)(!1),[j,k]=(0,r.useState)(null),[A,C]=(0,r.useState)(null),L=(0,r.useRef)(null),I=(0,r.useRef)(null),[R,N]=(0,r.useState)(1),[M,T]=(0,r.useState)(!1),[F,P]=(0,r.useState)(0),[E,U]=(0,r.useState)(100),[O,q]=(0,r.useState)(0),[V,G]=(0,r.useState)([]),[B,D]=(0,r.useState)(null),[_,H]=(0,r.useState)({x:0,y:0}),[z,W]=(0,r.useState)(0);console.log(x),console.log(j),console.log(R);let J=(0,r.useRef)(null),X=(0,r.useRef)([]),Y=()=>{let e=L.current;if(!(e instanceof HTMLCanvasElement)){console.warn("Canvas not found or is not a valid HTMLCanvasElement.");return}let t=e.captureStream(30);J.current=new MediaRecorder(t,{mimeType:"video/webm; codecs=vp9"}),J.current.ondataavailable=e=>{e.data.size>0&&X.current.push(e.data)},J.current.start(),console.log("Recording started...")},K=()=>{J.current&&(J.current.stop(),console.log("Recording stopped..."))};(0,r.useEffect)(()=>{let e=localStorage.getItem("uploadedSVGs");if(e){let n=JSON.parse(e);t(n),o(n[0]||null)}let n=localStorage.getItem("backgroundImage");n&&v(n)},[]);let Q=!1,Z=0,$=e=>{Q||(Z=e,Q=!0);let t=e-Z;if(t>=y){console.log("Animation completed."),Q=!1,cancelAnimationFrame(I.current);return}if(b){cancelAnimationFrame(I.current);return}let a=L.current;if(!(a instanceof HTMLCanvasElement)){console.warn("Canvas not found or is not a valid HTMLCanvasElement.");return}let r=a.getContext("2d");if(!r||!n){console.warn("Canvas context or SVG not available.");return}let l=new DOMParser().parseFromString(n,"image/svg+xml"),i=l.documentElement,o=i.querySelector("#hand-details-back"),s=i.querySelector("#hand-details-front"),c=i.querySelector("#pant-back-details"),d=i.querySelector("#pant-front-details"),u=i.querySelector("#leg-front"),m=i.querySelector("#leg-back"),g=i.querySelector("#shoe-front"),h=i.querySelector("#shoe-back");if(!o||!s||!c||!d||!u||!m||!g||!h){console.warn("Some elements are missing in the SVG.");return}let p=t%1e3/1e3,v=20*Math.sin(2*p*Math.PI),x=20*Math.cos(2*p*Math.PI),f=20*Math.cos(2*p*Math.PI),S=20*Math.cos(2*p*Math.PI),w=20*Math.cos(2*p*Math.PI),j=20*Math.cos(2*p*Math.PI);o.setAttribute("transform","rotate(".concat(v," 920 400)")),s.setAttribute("transform","rotate(".concat(-v," 960 400)")),c.setAttribute("transform","rotate(".concat(x," 1000 500)")),d.setAttribute("transform","rotate(".concat(-x," 1000 500)")),u.setAttribute("transform","rotate(".concat(-f," 1000 500)")),m.setAttribute("transform","rotate(".concat(S," 1000 500)")),g.setAttribute("transform","rotate(".concat(-w," 1000 500)")),h.setAttribute("transform","rotate(".concat(j," 1000 500)"));let k=new Blob([new XMLSerializer().serializeToString(l)],{type:"image/svg+xml;charset=utf-8"}),A=URL.createObjectURL(k),C=new Image;C.onload=()=>{r.clearRect(0,0,a.width,a.height),r.drawImage(C,_.x,_.y,a.width,a.height),URL.revokeObjectURL(A)},C.onerror=()=>{console.error("Failed to load updated SVG image.")},C.src=A,I.current=requestAnimationFrame($)},ee=()=>{Q||(I.current=requestAnimationFrame($))},et=e=>{Q||(Z=e,Q=!0);let t=e-Z;if(t>=y){console.log("Animation completed."),Q=!1,cancelAnimationFrame(I.current);return}if(b){cancelAnimationFrame(I.current);return}let a=L.current;if(!(a instanceof HTMLCanvasElement)){console.warn("Canvas not found or is not a valid HTMLCanvasElement.");return}let r=a.getContext("2d");if(!r||!n){console.warn("Canvas context or SVG not available.");return}let l=new DOMParser().parseFromString(n,"image/svg+xml"),i=l.documentElement,o=i.querySelector("#hand-details-back"),s=i.querySelector("#hand-details-front");if(!o||!s){console.warn("Some elements are missing in the SVG.");return}let c=(e,t)=>{let n=e[0],a=e[0];for(let r=0;r<e.length;r++)if(t>=e[r].t&&(n=e[r]),t<e[r].t){a=e[r];break}let r=a.t-n.t||1,l=a.v-n.v,i=(t-n.t)/r;return n.v+l*i},d=t%3e3;Object.entries({"hand-details-back":{keys:[{t:0,v:0},{t:400,v:-52.081355},{t:1200,v:-94.55654},{t:1700,v:-151.389937},{t:2300,v:-60.488341},{t:3e3,v:2.015952}],origin:{x:933.544556,y:375.9555}},"hand-details-front":{keys:[{t:0,v:4.969917},{t:400,v:-61.364093},{t:1200,v:-85.395581},{t:1700,v:-158.456814},{t:2300,v:-43.159225},{t:3e3,v:5.235948}],origin:{x:933.544556,y:381.769245}}}).forEach(e=>{let[t,{keys:n,origin:a}]=e,r=i.querySelector("#".concat(t));if(r){let e=c(n,d);r.setAttribute("transform","rotate(".concat(e," ").concat(a.x," ").concat(a.y,")"))}});let u=new Blob([new XMLSerializer().serializeToString(l)],{type:"image/svg+xml;charset=utf-8"}),m=URL.createObjectURL(u),g=new Image;g.onload=()=>{r.clearRect(0,0,a.width,a.height),r.drawImage(g,_.x,_.y,a.width,a.height),URL.revokeObjectURL(m)},g.onerror=()=>{console.error("Failed to load updated SVG image.")},g.src=m,I.current=requestAnimationFrame(et)},en=()=>{Q||(I.current=requestAnimationFrame(et))},ea=(e,t)=>{o(e),P(t)};(0,r.useEffect)(()=>{let e=null;return M?e=setInterval(()=>{N(e=>e>=100?0:e+1)},1e3):!M&&e&&clearInterval(e),()=>{e&&clearInterval(e)}},[M]);let er=()=>{if(n){let a=e.filter(e=>e!==n);t(a),localStorage.setItem("uploadedSVGs",JSON.stringify(a)),o(null)}f(null)},el=e=>{let t=parseInt(e.currentTarget.getAttribute("data-index")||"0",10);if(n){let e={svg:n,animationType:null,index:E,svgIndex:t};m(t=>[...t,e]),U(e=>e+1),G(e=>[...e,{type:"addSlide",slideIndex:E}])}},ei=(e,t)=>{s.find(t=>t.index===e)&&(t===d?(console.log("Playing walking animation for slide at index ".concat(e)),ee()):t===u&&(console.log("Playing handstand animation for slide at index ".concat(e)),en()))};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"frame-container",children:[(0,a.jsxs)("div",{className:"left-side",children:[(0,a.jsx)("h1",{className:"main-heading",children:"Upload"}),(0,a.jsxs)("div",{className:"choose_file-container",children:[(0,a.jsx)("label",{htmlFor:"file-upload",className:"custom-file-upload",children:"Upload SVGs"}),(0,a.jsx)("input",{id:"file-upload",type:"file",accept:".svg",multiple:!0,onChange:n=>{let a=n.target.files;if(a){let n=[];Array.from(a).forEach(r=>{if("image/svg+xml"===r.type){let l=new FileReader;l.onload=r=>{var l;let i=null===(l=r.target)||void 0===l?void 0:l.result;if(n.push(i),n.length===a.length){let a=[...e,...n];t(a),localStorage.setItem("uploadedSVGs",JSON.stringify(a)),o(a[0])}},l.readAsText(r)}else alert("File ".concat(r.name," is not a valid SVG file."))})}},className:"hidden"})]}),(0,a.jsxs)("div",{className:"choose_file-container",children:[(0,a.jsx)("label",{htmlFor:"background-upload",className:"custom-file-upload",children:"Upload Background"}),(0,a.jsx)("input",{id:"background-upload",type:"file",accept:"image/*",onChange:e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n&&n.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{var t;let n=null===(t=e.target)||void 0===t?void 0:t.result;v(n),localStorage.setItem("backgroundImage",n)},e.readAsDataURL(n)}else alert("Please upload a valid image file.")},className:"hidden"})]}),(0,a.jsx)("div",{className:"svg-thumb-container",children:e.length>0?e.map((e,t)=>(0,a.jsxs)("div",{style:{position:"relative",height:"200px",border:"1px solid #ccc",marginBottom:"50px",cursor:"pointer"},className:F===t?"active":"",children:[(0,a.jsx)("div",{onClick:()=>ea(e,t),dangerouslySetInnerHTML:{__html:e},style:{width:"100%",height:"100%"}}),(0,a.jsxs)("div",{className:"add-and-delete-buttons",children:[(0,a.jsx)("button",{onClick:e=>el(e),"data-index":t,style:{padding:"12px 10px",backgroundColor:"#4CAF50",color:"white",border:"none",cursor:"pointer",width:"50%"},children:"Add Slide"}),(0,a.jsx)("button",{onClick:()=>er(),style:{padding:"12px 10px",backgroundColor:"#f44336",color:"white",border:"none",cursor:"pointer",width:"50%"},children:"Delete"})]})]},t)):(0,a.jsx)("p",{children:"No SVGs uploaded yet."})}),(0,a.jsxs)("div",{className:"layers-prev-container",children:[(0,a.jsx)("h1",{className:"main-heading",children:"Animations"}),(0,a.jsx)("div",{className:"layersOuter",children:(0,a.jsx)(l,{playWalkingAnimation:ee,addAnimation:()=>{let e=document.querySelector(".timeline-test");e&&(e.classList.toggle("animation-class"),console.log("Animation added/removed on target element"))},handleWalkingAnimation:()=>{null!==F&&m(e=>e.map(e=>e.index===F?(G(e=>[...e,{type:"assignAnimation",slideIndex:F,animationType:d}]),{...e,animationType:e.animationType===d?null:d}):e))},handlehandstandAnimation:()=>{null!==F&&m(e=>e.map(e=>e.index===F?(G(e=>[...e,{type:"assignAnimation",slideIndex:F,animationType:u}]),{...e,animationType:e.animationType===u?null:u}):e))}})})]})]}),(0,a.jsx)("div",{className:"right-side",children:(0,a.jsx)(c,{setSvgDataList:t,selectedSvg:n,backgroundImage:p,svgContainerRef:L,setBackgroundImage:v,isPlaying:M,togglePlayPause:()=>{T(e=>!e)},selectedLayers:g,playAnimation:()=>{S(3e4),b&&null!==A?(k(e=>(null!=e?e:0)+performance.now()-A),w(!1),C(null)):k(null),I.current=requestAnimationFrame($)},slideForTimeline:s,playWalkingAnimation:ee,handleSvgClick:ea,selectedSvgIndex:F,currentReplayIndex:B,svgPosition:_,setSvgPosition:H,replayActivities:()=>{let e=L.current;if(!(e instanceof HTMLCanvasElement)){console.warn("Canvas not found or is not a valid HTMLCanvasElement.");return}let t=e.getContext("2d");if(!t){console.warn("Canvas context not available.");return}if(0===V.length){console.warn("No activities to replay.");return}console.log("Starting replay and recording..."),Y();let n=1e3*V.length,a=0,r=l=>{if(l>=V.length){D(null),K(),console.log("Replay completed.");return}let i=V[l],c=s.find(e=>e.index===i.slideIndex);if(!c){console.warn("Slide not found for index ".concat(i.slideIndex)),r(l+1);return}if(o(c.svg),D(i.slideIndex),t.clearRect(0,0,e.width,e.height),"addSlide"===i.type){let n=c.svg;if(n){let a=new Image,r=new Blob([n],{type:"image/svg+xml"}),l=URL.createObjectURL(r);a.onload=()=>{t.drawImage(a,0,0,e.width,e.height),URL.revokeObjectURL(l)},a.onerror=e=>{console.error("Error loading SVG image:",e)},a.src=l}}else"assignAnimation"===i.type&&ei(i.slideIndex,i.animationType);W(a/n*40),q(Math.floor(a/1e3)),setTimeout(()=>{a+=1e3,r(l+1)},1e3)};r(0)},downloadVideo:()=>{let e=new Blob(X.current,{type:"video/mp4"}),t=URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="activities-logs.mp4",document.body.appendChild(n),n.click(),URL.revokeObjectURL(t),document.body.removeChild(n),console.log("Video downloaded...")},playheadPosition:z,seconds:O})}),(0,a.jsx)("div",{className:"leayrs-container",children:(0,a.jsx)(i,{selectedSvg:n,parseSvgLayers:e=>Array.from(new DOMParser().parseFromString(e,"image/svg+xml").documentElement.querySelectorAll(":scope > g")).map((e,t)=>({index:t,id:e.id||"Layer ".concat(t),children:Array.from(e.children)})),selectedLayers:g,handleLayerClick:e=>{h([e])}})})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(7237)),_N_E=e.O()}]);